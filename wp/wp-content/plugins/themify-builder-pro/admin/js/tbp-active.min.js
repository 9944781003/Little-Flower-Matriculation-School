'use strict';jQuery(function(e){var b=tb_app,h=null,q=function(f,a){var d=f.getElementsByClassName("tbp_advanchd_archive_wrap")[0],c=-1!==a.get("mod_name").indexOf("product")?"_product":"",n="tbp_edit"+c+"_archive",p="tbp_edit"+c+"_single",k=e("."+n);c=["order","orderby","offset","meta_key"];var l=a.get("element_id"),m=e.extend(!0,{},a.get("mod_settings"));d.classList.add("themify_builder_content");d.classList.add("themify_builder_content-"+l);d.classList.add("themify_builder");d.setAttribute("id",
"themify_builder_content-"+l);d.setAttribute("data-postid",l);d=m.builder_content;"string"===typeof d&&(d=JSON.parse(d));h={};c.push("terms");c.push("term_type");c.push("tax");c.push("post_type");for(var g=c.length-1;-1<g;--g)void 0!==m[c[g]]&&""!==m[c[g]]&&(h[c[g]]=m[c[g]]);h.aap_preview=1;m=null;b.Forms.LayoutPart.cache[l]=d;b.activeModel=b.ActionBar.hoverCid=d=null;document.body.className+=" tbp_app_is_edit tbp_module_"+a.get("mod_name");window.top.document.body.className+=" tbp_app_is_edit tbp_module_"+
a.get("mod_name");k=k.add(e("."+n,window.top.document));for(g=k.length-1;-1<g;--g)k[g].classList.remove(n),k[g].classList.add(p);e(f).one("tb_layout_part_before_init",function(){var c=e(this).find(".tb_toolbar_save"),d=e(this).find(".tb_toolbar_close_btn");c.on("click",function(c){c.preventDefault();c.stopImmediatePropagation();if(null!==b.activeModel||0<ThemifyBuilderCommon.Lightbox.$lightbox.length&&ThemifyBuilderCommon.Lightbox.$lightbox[0].classList.contains("tb_custom_css_lightbox"))c=ThemifyBuilderCommon.Lightbox.$lightbox[0].getElementsByClassName("builder_save_button")[0],
void 0!==c&&c.click(),c=null;c=a.get("mod_settings");c.builder_content=b.Utils.clear(b.Mixins.Builder.toJSON(b.Instances.Builder[b.builderIndex].el));a.set(c,{silent:!0});ThemifyBuilderCommon.showLoader("show");setTimeout(function(){ThemifyBuilderCommon.showLoader("hide");b.Forms.LayoutPart.options=null;b.Forms.LayoutPart.isSaved=!0},100)});d.on("click",function(d){d.preventDefault();d.stopImmediatePropagation();var f=!0===b.Forms.LayoutPart.isSaved;h=null;b.Forms.LayoutPart.close(d);if(!0===f||0===
b.builderIndex){e(this).off("click");c.off("click");delete b.Forms.LayoutPart.cache[l];b.activeModel=b.ActionBar.hoverCid=null;document.body.classList.remove("tbp_app_is_edit");document.body.classList.remove("tbp_module_"+a.get("mod_name"));window.top.document.body.classList.remove("tbp_app_is_edit");window.top.document.body.classList.remove("tbp_module_"+a.get("mod_name"));for(d=k.length-1;-1<d;--d)k[d].classList.add(n),k[d].classList.remove(p);!0===f&&(ThemifyBuilderCommon.showLoader("show"),a.trigger("custom:preview:refresh",
a.get("mod_settings")),setTimeout(function(){b.ActionBar.hoverCid=null;ThemifyBuilderCommon.showLoader("hide")},220))}});e(".tb_overlay").first().one("dblclick",function(a){a.preventDefault();a.stopImmediatePropagation();b.Forms.LayoutPart.options=null;b.Forms.LayoutPart.isSaved=!0;c.triggerHandler("click");d.triggerHandler("click")})})};b.Constructor.tbp_mixed={render:function(b,a){return a.query_posts.render({type:"query_posts",id:"post_type",tax_id:"tax",term_id:"terms",slug_id:"slug",wrap_class:"tbp_app_post_query"},
a)}};b.Constructor.tbp_advanched_layout={render:function(f,a){var d=document.createDocumentFragment();if("visual"===b.mode){var c=document.createElement("a"),e=function(a){a.stopPropagation();a.preventDefault();this.removeEventListener("click",e,{once:!0});var c=b.activeModel.cid;ThemifyConstructor.saveComponent();this.className+=" tb_edit";b.Models.Registry.lookup(c).trigger("edit",a,this)};c.className="tbp_advanched_archive_edit";c.href="#";c.textContent=tbp_local.edit;c.addEventListener("click",
e,{once:!0});d.appendChild(c)}a.values[f.id]&&(a.values[f.id]=JSON.stringify(a.values[f.id]));d.appendChild(a.hidden.render(f,a));return d}};b.Constructor.fallback={render:function(b,a){return a.create([{id:"fallback_s",type:"toggle_switch",label:"fall_b",options:{on:{name:"yes",value:"en"},off:{name:"no",value:"dis"}},binding:{checked:{show:["fallback_i"]},not_checked:{hide:["fallback_i"]}}},{id:"fallback_i",type:"image",wrap_class:"pushed","class":"xlarge"}])}};b.Constructor.tbp_custom_css={render:function(b,
a){return a.create([{id:"css",type:"custom_css"},{type:"custom_css_id"}])}};"visual"===b.mode&&(e.ajaxPrefilter(function(b,a,d){if(a.data&&("tb_render_element"===a.data.action||"tb_load_module_partial"===a.data.action)){b.data+="&pageId="+tbp_local.id;a=null;if(null!==h)for(var c in h)"tax"===c?a=h[c]:b.data+="&"+c+"="+h[c];null===a&&(a=tbp_local.type);b.data+="&type="+a}}),Themify.body.on("tb_edit_advanced-posts tb_edit_advanced-products",function(f,a,d,c){if(!b.Forms.LayoutPart.id&&a&&("dblclick"===
a.type||a.target.classList.contains("tb_edit")))return null!==b.activeModel&&e(".builder_save_button",ThemifyBuilderCommon.Lightbox.$lightbox[0]).click(),q(d,c),!0}),Themify.LoadCss(tbp_local.cssUrl,tbp_local.v),window.top.Themify.LoadCss(tbp_local.cssUrl,tbp_local.v),tbp_local.cssUrl=null);Themify.body.one("builder_load_module_partial",function(){"undefined"!==typeof tbp_local&&tbp_local.template&&(document.body.classList.add("tbp_template_type_"+tbp_local.template),window.top.document.body.classList.add("tbp_template_type_"+
tbp_local.template))});e(document).on("tb_editing_module",function(b){var a=themifyBuilder.DynamicQuery.input;e(ThemifyBuilderCommon.Lightbox.$lightbox[0]).find('.tb_field[data-type="query_posts"]').each(function(){var b=e(this);if(!b.prev(".tb_field.tbpdq").length){var c=b.find(".tb_search_input.tb_lb_option:first").attr("id");a.binding={off:{show:[c]},on:{hide:[c]}};e(ThemifyConstructor.create([a])).insertBefore(b)}})})});
